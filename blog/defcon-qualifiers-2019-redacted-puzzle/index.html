<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><link href=https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css rel=stylesheet integrity=sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65 crossorigin=anonymous><script src=https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js integrity=sha384-kenU1KFdBIe4zVF0s0G1M5b4hcpxyD9F7jL+jjXkk+Q2h455rYXK/7HAuoJl+0I4 crossorigin=anonymous></script>
<link rel=preconnect href=https://fonts.googleapis.com><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link href="https://fonts.googleapis.com/css2?family=Mulish:wght@300;600;800&family=Open+Sans:wght@400;600&display=swap" rel=stylesheet><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.9.0/css/all.min.css integrity="sha512-q3eWabyZPc1XTCmF+8/LuE1ozpg5xxn7iO89yfSOd5/oKvyqLngoNGsx8jq92Y8eXJ/IRxQbEC+FGSYxtk2oiw==" crossorigin=anonymous referrerpolicy=no-referrer><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.9.0/css/solid.min.css integrity="sha512-LopA1sokwAW/FNZdP+/5q8MGyb9CojL1LTz8JMyu/8YZ8XaCDn1EOm6L7RWIIOHRM7K4jwnHuOmyLZeeeYxSOA==" crossorigin=anonymous referrerpolicy=no-referrer><link rel=stylesheet href=/caseyhates.css><title>DefCon Qualifiers 2019 - redacted-puzzle | OSU Security Club</title></head><body id=background-img style=background-image:url(/blog/defcon-qualifiers-2019-redacted-puzzle.jpg);background-position:50%><nav class="navbar navbar-expand-lg px-lg-5 py-lg-2 fixed-top topbar bg-light"><div class="container-fluid flex-nowrap px-lg-5"><a class=navbar-brand href=/><img src=/osusec-banner.png class=img-fluid alt=OSUSEC width=450px></a>
<button class=navbar-toggler type=button data-bs-toggle=collapse data-bs-target=#navbarSupportedContent aria-controls=navbarSupportedContent aria-expanded=false aria-label="Toggle navigation">
<span class=navbar-toggler-icon></span></button><div class="collapse navbar-collapse" id=navbarSupportedContent><ul class="navbar-nav me-auto mb-2 mb-lg-0"></ul><ul class="navbar-nav d-flex mb-2 mb-lg-0"><li class="nav-item px-1"><a class="nav-link highlight-orange-nav" href=/>Home</a></li><li class="nav-item px-1 dropdown"><a class="nav-link text-black dropdown-toggle" href=# role=button data-bs-toggle=dropdown aria-expanded=false>About</a><ul class=dropdown-menu><li><a class="dropdown-item topbar topbar-drop shadow-none" href=/about/>Who We Are</a></li><li><a class="dropdown-item topbar topbar-drop shadow-none" href=/club-constitution/>Club Constitution</a></li><li><a class="dropdown-item topbar topbar-drop shadow-none" href=/wicys/>WiCyS</a></li></ul></li><li class="nav-item px-1"><a class="nav-link highlight-orange-nav" href=/calendar/>Calendar</a></li><li class="nav-item px-1"><a class="nav-link highlight-orange-nav" href=/blog/>Blog</a></li><li class="nav-item px-1"><a class="nav-link highlight-orange-nav" href=/ctf-league/>CTF League</a></li><li class="nav-item px-1"><a class="nav-link highlight-orange-nav" href=/accomplishments/>Accomplishments</a></li><li class="nav-item px-1"><a class="nav-link highlight-orange-nav" href=/resources/>Resources</a></li></ul></div></div></nav><main id=main><div id=home-jumbotron class="jumbotron text-center hero-content infopage-hero d-flex flex-column justify-content-center"><h1 class="hero-title py-1">DefCon Qualifiers 2019 - redacted-puzzle</h1></div><div class="bg-light justify-content-center infopage-content" style=min-height:60vh><div class=blog-content><h1 class=blog-title>DefCon Qualifiers 2019 - redacted-puzzle</h1><div class="blog-subtext d-flex flex-wrap"><p class=blog-subtext-item><i class="fa fa-user"></i> Lyell Read</p><p class=blog-subtext-item><i class="fa fa-folder"></i> Tags</p><p class=blog-subtext-item><i class="fa fa-calendar"></i> <time datetime=2019-05-12>May 12, 2019</time></p></div><img src=/blog/defcon-qualifiers-2019-redacted-puzzle.jpg alt class=blogcard-img><div class=blog-content-text><p>The only file given is a GIF image, named <a href=redacted-puzzle.gif>redacted-puzzle.gif</a>. We must first inspect it:</p><pre tabindex=0><code>$ exiftool redacted-puzzle.gif
ExifTool Version Number         : 10.80
File Name                       : redacted-puzzle.gif
Directory                       : .
File Size                       : 78 kB
File Modification Date/Time     : 2019:05:10 17:05:42-07:00
File Access Date/Time           : 2019:05:10 17:05:42-07:00
File Inode Change Date/Time     : 2019:05:10 17:26:26-07:00
File Permissions                : rwxrwxrwx
File Type                       : GIF
File Type Extension             : gif
MIME Type                       : image/gif
GIF Version                     : 89a
Image Width                     : 1280
Image Height                    : 720
Has Color Map                   : Yes
Color Resolution Depth          : 3
Bits Per Pixel                  : 2
Background Color                : 3
Animation Iterations            : Infinite
Frame Count                     : 35
Duration                        : 8.75 s
Image Size                      : 1280x720
Megapixels                      : 0.922
</code></pre><p>OK. We know that this is likely a GIF with 35 frames. Let’s try opening it:</p><p><img src=/blog/defcon-qualifiers-2019-redacted-puzzle-1.jpg alt></p><p>Let’s gather some more information about this GIF:</p><pre tabindex=0><code>$identify -verbose redacted-puzzle.gif

 . . .

  Colormap:
         0: (  0,  0,  0,255) #000000FF graya(0,1)
         1: (  0,  0,  0,255) #000000FF graya(0,1)
         2: (  0,  0,  0,255) #000000FF graya(0,1)
         3: (255,255,255,  0) #FFFFFF00 graya(255,0)

 . . . 
</code></pre><p>That is a bit of a weird color map… Those should correspond with different colors. Let’s open this image in <a href=https://www.gimp.org/>gimp</a>. We use the <code>Open as Layers</code> option to get each frame as an individual layer.</p><p><img src=/blog/defcon-qualifiers-2019-redacted-puzzle-2.jpg alt></p><p>Much layers. Next, we gotta fix that color mapping issue. <code>Colors>Map>Set Color Map</code> and choose <code>Pallete>Ega</code>:</p><p><img src=/blog/defcon-qualifiers-2019-redacted-puzzle-3.jpg alt></p><p>Well, we know what the flag’s alphabet will be. Then, after looking at each slide . . .</p><p><img src=/blog/defcon-qualifiers-2019-redacted-puzzle-4.jpg alt></p><p>We determined it best to remove the black backgrounds on each. One by one.</p><p><img src=/blog/defcon-qualifiers-2019-redacted-puzzle-5.jpg alt></p><p>Now we can see them all overlapping. They form some sort of circle:</p><p><img src=/blog/defcon-qualifiers-2019-redacted-puzzle-6.jpg alt></p><p>Let’s examine only a couple…</p><p><img src=/blog/defcon-qualifiers-2019-redacted-puzzle-7.jpg alt></p><p>That is intresting. Going off a hunch, we decided to build sets of binary digits representing if the vertex of a frame was where one of the verticies of the overall ‘octagon’, using dots in the background:</p><p><img src=/blog/defcon-qualifiers-2019-redacted-puzzle-8.jpg alt></p><p><img src=/blog/defcon-qualifiers-2019-redacted-puzzle-9.jpg alt></p><p>As we repeated that for each layer, the shapes’ verticies started to ‘rotate’, or ‘drift’ (thus why when all overlayed, they formed a circle, not octagon). We decided to track the movment and adjust the background dots. We generated the ‘bytes’:</p><pre tabindex=0><code>verticies = [&#39;10001100&#39;, &#39;01100011&#39;, &#39;11100100&#39;, &#39;01000110&#39;, 10000101&#39;, &#39;00111101&#39;, &#39;01000010&#39;, &#39;10011000&#39;, &#39;11100000&#39;, &#39;11110100&#39;, &#39;10000000&#39;, &#39;00101101&#39;, &#39;01110010&#39;, &#39;00011100&#39;, &#39;00001000&#39;, &#39;10100101&#39;, &#39;11010111&#39;, &#39;01101110&#39;, &#39;10100110&#39;, &#39;10010001&#39;, &#39;10111100&#39;, &#39;10000100&#39;, &#39;10000001&#39;, &#39;10111001&#39;, &#39;11010100&#39;, &#39;00111011&#39;, &#39;11001110&#39;, &#39;11110010&#39;, &#39;00011110&#39;, &#39;10011101&#39;, &#39;11001001&#39;, &#39;11000111&#39;, &#39;01100101&#39;, &#39;00011110&#39;, &#39;10011111&#39;]
</code></pre><p>Now comes the challenge of making sense of those. We know that the first three should be the same (which they arent) because flags start with <code>OOO...</code>. A pattern appears when you concattenate the first couple ‘bytes’:</p><pre tabindex=0><code>100011000110001....
</code></pre><p>That looks to be three identical 5- bit numbers. Concattenating all of the <code>verticies</code> and splitting them by 5’s yields:</p><pre tabindex=0><code>cintuplets = [&#39;10001&#39;, &#39;10001&#39;, &#39;10001&#39;, &#39;11110&#39;, &#39;01000&#39;, &#39;10001&#39;, &#39;10100&#39;, &#39;00101&#39;, &#39;00111&#39;, &#39;10101&#39;, &#39;00001&#39;, &#39;01001&#39;, &#39;10001&#39;, &#39;11000&#39;, &#39;00111&#39;, &#39;10100&#39;, &#39;10000&#39;, &#39;00000&#39;, &#39;10110&#39;, &#39;10111&#39;, &#39;00100&#39;, &#39;00111&#39;, &#39;00000&#39;, &#39;01000&#39;, &#39;10100&#39;, &#39;10111&#39;, &#39;01011&#39;, &#39;10110&#39;, &#39;11101&#39;, &#39;01001&#39;, &#39;10100&#39;, &#39;10001&#39;, &#39;10111&#39;, &#39;10010&#39;, &#39;00010&#39;, &#39;01000&#39;, &#39;00011&#39;, &#39;01110&#39;, &#39;01110&#39;, &#39;10100&#39;, &#39;00111&#39;, &#39;01111&#39;, &#39;00111&#39;, &#39;01111&#39;, &#39;00100&#39;, &#39;00111&#39;, &#39;10100&#39;, &#39;11101&#39;, &#39;11001&#39;, &#39;00111&#39;, &#39;00011&#39;, &#39;10110&#39;, &#39;01010&#39;, &#39;00111&#39;, &#39;10100&#39;, &#39;11111&#39;]
</code></pre><p>Those first couple convert to be 17 in decimal. Coincidentally, at index 17 of our alphabet is the letter ‘O’.</p><p>Note that in <a href=https://github.com/lyellread/ctf-writeups/blob/master/defcon-qualifiers-2019/redacted-puzzle-writeup/redacted-puzzle-solve.py>redacted-puzzle-solve.py</a> we exclude the location that you started forming the bits for each byte of <code>verticies</code> from on the octagon.</p><pre tabindex=0><code>OOO{FORCES-GOVERN+TUBE+FRUIT_GROUP=FALLREMEMBER_WEATHER}
</code></pre></div></div></div></main><footer class="border-top py-4 bg-light"><div class="text-muted text-center"><p>© 2024 OSU Security Club.</p><p>Contact us at: <a href=mailto:security.clubs@oregonstate.edu class="text-reset text-decoration-none fw-bold">security.clubs@oregonstate.edu</a></p></div></footer></body></html>