<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><link href=https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css rel=stylesheet integrity=sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65 crossorigin=anonymous><script src=https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js integrity=sha384-kenU1KFdBIe4zVF0s0G1M5b4hcpxyD9F7jL+jjXkk+Q2h455rYXK/7HAuoJl+0I4 crossorigin=anonymous></script>
<link rel=preconnect href=https://fonts.googleapis.com><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link href="https://fonts.googleapis.com/css2?family=Mulish:wght@300;600;800&family=Open+Sans:wght@400;600&display=swap" rel=stylesheet><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.9.0/css/all.min.css integrity="sha512-q3eWabyZPc1XTCmF+8/LuE1ozpg5xxn7iO89yfSOd5/oKvyqLngoNGsx8jq92Y8eXJ/IRxQbEC+FGSYxtk2oiw==" crossorigin=anonymous referrerpolicy=no-referrer><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.9.0/css/solid.min.css integrity="sha512-LopA1sokwAW/FNZdP+/5q8MGyb9CojL1LTz8JMyu/8YZ8XaCDn1EOm6L7RWIIOHRM7K4jwnHuOmyLZeeeYxSOA==" crossorigin=anonymous referrerpolicy=no-referrer><link rel=stylesheet href=/caseyhates.css><title>IJCTF - Vault Writeup | OSU Security Club</title></head><body id=background-img style=background-image:url(/blog/ijctf-vault-writeup.jpg);background-position:50%><nav class="navbar navbar-expand-lg px-lg-5 py-lg-2 fixed-top topbar bg-light"><div class="container-fluid flex-nowrap px-lg-5"><a class=navbar-brand href=/><img src=/osusec-banner.png class=img-fluid alt=OSUSEC width=450px></a>
<button class=navbar-toggler type=button data-bs-toggle=collapse data-bs-target=#navbarSupportedContent aria-controls=navbarSupportedContent aria-expanded=false aria-label="Toggle navigation">
<span class=navbar-toggler-icon></span></button><div class="collapse navbar-collapse" id=navbarSupportedContent><ul class="navbar-nav me-auto mb-2 mb-lg-0"></ul><ul class="navbar-nav d-flex mb-2 mb-lg-0"><li class="nav-item px-1"><a class="nav-link highlight-orange-nav" href=/>Home</a></li><li class="nav-item px-1 dropdown"><a class="nav-link text-black dropdown-toggle" href=# role=button data-bs-toggle=dropdown aria-expanded=false>About</a><ul class=dropdown-menu><li><a class="dropdown-item topbar topbar-drop shadow-none" href=/about/>Who We Are</a></li><li><a class="dropdown-item topbar topbar-drop shadow-none" href=/club-constitution/>Club Constitution</a></li><li><a class="dropdown-item topbar topbar-drop shadow-none" href=/wicys/>WiCyS</a></li></ul></li><li class="nav-item px-1"><a class="nav-link highlight-orange-nav" href=/calendar/>Calendar</a></li><li class="nav-item px-1"><a class="nav-link highlight-orange-nav" href=/blog/>Blog</a></li><li class="nav-item px-1"><a class="nav-link highlight-orange-nav" href=/ctf-league/>CTF League</a></li><li class="nav-item px-1"><a class="nav-link highlight-orange-nav" href=/accomplishments/>Accomplishments</a></li><li class="nav-item px-1"><a class="nav-link highlight-orange-nav" href=/resources/>Resources</a></li></ul></div></div></nav><main id=main><div id=home-jumbotron class="jumbotron text-center hero-content infopage-hero d-flex flex-column justify-content-center"><h1 class="hero-title py-1">IJCTF - Vault Writeup</h1></div><div class="bg-light justify-content-center infopage-content" style=min-height:60vh><div class=blog-content><h1 class=blog-title>IJCTF - Vault Writeup</h1><div class="blog-subtext d-flex flex-wrap"><p class=blog-subtext-item><i class="fa fa-user"></i> Lyell Read</p><p class=blog-subtext-item><i class="fa fa-folder"></i> Tags</p><p class=blog-subtext-item><i class="fa fa-calendar"></i> <time datetime=2020-04-26>Apr 26, 2020</time></p></div><img src=/blog/ijctf-vault-writeup.jpg alt="IJCTF logo" class=blogcard-img><div class=blog-content-text><h2 id=prompt>Prompt</h2><blockquote><p>We locked our secret box, You can directly ping the bot (@Vault #8895 ) using “start” to get the secret but we don’t know the door code we used random() also we used sleep(10).</p><p>shift register…</p><p>Author : Harsh and warlock_rootx</p><p>Hint: if pin in user_input(): #Good Stuff…</p></blockquote><h2 id=solution>Solution</h2><p>This problem (and especially the hint) make clear what we have to do. We need to provide the discord bot with as many possible passcodes as we can for the suggested charset and length as possible… now, discord makes this hard, as messages are limited to 2000 characters. The bot asks for these passcodes:</p><pre tabindex=0><code>[0, 1]				l=7
[4, 5, 6] 			l=6
[5, 6, 7, 8, 9] 	l=4
[1, 2, 3, 4] 		l=5
[0, 1, 2, 5, 8, 9] 	l=4
[0, 1] 				l=11
</code></pre><p>Despite sometimes having to choose as little as 1/12 of the total passcode wordlist size, I was able to get the challenge during the ctf with a ‘bruteforce’ tactic. The strings that I sent are in <a href=https://github.com/lyellread/ctf-writeups/blob/master/2020-ijctf/vault/strings-bruteforce.txt>strings-bruteforce.txt</a>, and they worked in a couple of tries (the odds were better than they may seem, as overlapping passcodes count too). Some passcode sets (like that of the last problem). I made these strings with python itertools:</p><pre tabindex=0><code>import itertools
passcode_list = list(itertools.product(charset, repeat=length))
print(&#39;&#39;.join([&#39;&#39;.join(y) for y in passcode_list]))
</code></pre><p>After the CTF, though, I was nagged by the fact that I could improve on this… I therefore made a partial superstring program to make the strings shorter, and include more possible passcodes per message to the bot. It is <a href=https://github.com/lyellread/ctf-writeups/blob/master/2020-ijctf/vault/superstring.py>here</a>, and it creates <a href=https://github.com/lyellread/ctf-writeups/blob/master/2020-ijctf/vault/strings-partial-superstring.txt>these passcode lists</a>. All apart from the last one will be 100% reliable, as I had to shave 200 characters off the last one. My superstring algorithm is lazily made, and not perfect, so there exists a case where one could compose strings that would contain all passcodes for all challenges proposed by the bot.</p><p>All in all a fun quick chall!</p><pre tabindex=0><code>IJCTF{0p3n3d_d3_bru1jn_v4ul75}
</code></pre><p>~ Lyell Read</p></div></div></div></main><footer class="border-top py-4 bg-light"><div class="text-muted text-center"><p>© <script>document.write((new Date).getFullYear())</script>&nbsp;OSU Security Club.</p><p>Contact us at:
<a href=mailto:security.clubs@oregonstate.edu class="text-reset text-decoration-none fw-bold">security.clubs@oregonstate.edu</a></p><div class=mt-3><div class="d-flex justify-content-center gap-3"><a href=https://www.instagram.com/dam.secure/ target=_blank class=text-reset title=Instagram><i class="fab fa-instagram" aria-hidden=true></i></a>
<a href=https://x.com/OSUSEC target=_blank class=text-reset title=Twitter><i class="fab fa-twitter" aria-hidden=true></i></a></div></div></div></footer></body></html>