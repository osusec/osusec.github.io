<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><link href=https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css rel=stylesheet integrity=sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65 crossorigin=anonymous><script src=https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js integrity=sha384-kenU1KFdBIe4zVF0s0G1M5b4hcpxyD9F7jL+jjXkk+Q2h455rYXK/7HAuoJl+0I4 crossorigin=anonymous></script>
<link rel=preconnect href=https://fonts.googleapis.com><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link href="https://fonts.googleapis.com/css2?family=Mulish:wght@300;600;800&family=Open+Sans:wght@400;600&display=swap" rel=stylesheet><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.9.0/css/all.min.css integrity="sha512-q3eWabyZPc1XTCmF+8/LuE1ozpg5xxn7iO89yfSOd5/oKvyqLngoNGsx8jq92Y8eXJ/IRxQbEC+FGSYxtk2oiw==" crossorigin=anonymous referrerpolicy=no-referrer><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.9.0/css/solid.min.css integrity="sha512-LopA1sokwAW/FNZdP+/5q8MGyb9CojL1LTz8JMyu/8YZ8XaCDn1EOm6L7RWIIOHRM7K4jwnHuOmyLZeeeYxSOA==" crossorigin=anonymous referrerpolicy=no-referrer><link rel=stylesheet href=/caseyhates.css><title>BSidesPDX - Down the Rabbit Hole | OSU Security Club</title></head><body id=background-img style=background-image:url(/blog/bsidespdx-down-the-rabbit-hole.jpg);background-position:50%><nav class="navbar navbar-expand-lg px-lg-5 py-lg-2 fixed-top topbar bg-light"><div class="container-fluid flex-nowrap px-lg-5"><a class=navbar-brand href=/><img src=/osusec-banner.png class=img-fluid alt=OSUSEC width=450px></a>
<button class=navbar-toggler type=button data-bs-toggle=collapse data-bs-target=#navbarSupportedContent aria-controls=navbarSupportedContent aria-expanded=false aria-label="Toggle navigation">
<span class=navbar-toggler-icon></span></button><div class="collapse navbar-collapse" id=navbarSupportedContent><ul class="navbar-nav me-auto mb-2 mb-lg-0"></ul><ul class="navbar-nav d-flex mb-2 mb-lg-0"><li class="nav-item px-1"><a class="nav-link highlight-orange-nav" href=/>Home</a></li><li class="nav-item px-1 dropdown"><a class="nav-link text-black dropdown-toggle" href=# role=button data-bs-toggle=dropdown aria-expanded=false>About</a><ul class=dropdown-menu><li><a class="dropdown-item topbar topbar-drop shadow-none" href=/about/>Who We Are</a></li><li><a class="dropdown-item topbar topbar-drop shadow-none" href=/club-constitution/>Club Constitution</a></li><li><a class="dropdown-item topbar topbar-drop shadow-none" href=/wicys/>WiCyS</a></li></ul></li><li class="nav-item px-1"><a class="nav-link highlight-orange-nav" href=/calendar/>Calendar</a></li><li class="nav-item px-1"><a class="nav-link highlight-orange-nav" href=/blog/>Blog</a></li><li class="nav-item px-1"><a class="nav-link highlight-orange-nav" href=/ctf-league/>CTF League</a></li><li class="nav-item px-1"><a class="nav-link highlight-orange-nav" href=/accomplishments/>Accomplishments</a></li><li class="nav-item px-1"><a class="nav-link highlight-orange-nav" href=/resources/>Resources</a></li></ul></div></div></nav><main id=main><div id=home-jumbotron class="jumbotron text-center hero-content infopage-hero d-flex flex-column justify-content-center"><h1 class="hero-title py-1">BSidesPDX - Down the Rabbit Hole</h1></div><div class="bg-light justify-content-center infopage-content" style=min-height:60vh><div class=blog-content><h1 class=blog-title>BSidesPDX - Down the Rabbit Hole</h1><div class="blog-subtext d-flex flex-wrap"><p class=blog-subtext-item><i class="fa fa-user"></i> Lyell Read</p><p class=blog-subtext-item><i class="fa fa-folder"></i> Tags</p><p class=blog-subtext-item><i class="fa fa-calendar"></i> <time datetime=2020-10-25>Oct 25, 2020</time></p></div><img src=/blog/bsidespdx-down-the-rabbit-hole.jpg alt="BSidesPDX logo" class=blogcard-img><div class=blog-content-text><h2 id=prompt>Prompt</h2><p>Category: Over The Air</p><p>297 Points</p><p>5 Solves</p><blockquote><p>During one of the commercial breaks of my favorite state sponsored educational video, there was some interference once again. There was a woman wearing some sort of face mask and there were strange tones. The tones were familiar and rang a bell, but I couldn’t quite put my finger on them. I don’t know what these things mean, but maybe you can figure it out.</p><p><a href=twitch.tv/over_the_air>twitch.tv/over_the_air</a></p><p>Author(s): 0xdade & fdcarl</p></blockquote><h2 id=solution>Solution</h2><p>This challenge is where we really… umm… go down the rabbit hole, you could say ;). I started by playing the whole video and noting all the oddities that I could find, and started working them out one by one:</p><ul><li><a href=https://youtu.be/_QgPMyRBBKM>[00:00]</a> : Many QR codes on the standby screen (challenge 1, “please stand by”)</li><li><a href="https://youtu.be/_QgPMyRBBKM?t=175">[02:55]</a> : Creepy appearance behind the betty crocker advertisement.</li><li><a href="https://youtu.be/_QgPMyRBBKM?t=291">[04:51]</a> : Sneezing guy repeated a couple times in quick succession.</li><li><a href="https://youtu.be/_QgPMyRBBKM?t=353">[05:53]</a> : In the duck & cover / burt the turtle clip, there’s a flag person in the bottom left that is sending text in the maritime flag signaling pattern.</li><li><a href="https://youtu.be/_QgPMyRBBKM?t=504">[08:24]</a>: In the atomic bomb / duck & cover intro, when in Betty’s school, a creepy plague doctor mask guy with numbers and letters, and a tune (challenge 2, “xclusive numborz”)</li><li><a href="https://youtu.be/_QgPMyRBBKM?t=846">[14:06]</a> : When Tony is going to cubscouts / picnic – creepy guy overlay w anonymous-like mask on.</li><li><a href="https://youtu.be/_QgPMyRBBKM?t=946">[15:46]</a> : In the announcement about the Secret Squadron, <code>0x13A5C</code> is displayed, and a number is heard dialing in the background.</li><li><a href="https://youtu.be/_QgPMyRBBKM?t=1041">[17:21]</a> : Giant Behemoth: A message appears on the top of the screen.</li></ul><p>So, we eliminated or decoded one thing at a time, omitting the parts from previous challenges:</p><ul><li><a href="https://youtu.be/_QgPMyRBBKM?t=353">[05:53]</a> : In the duck & cover / burt the turtle clip, there’s a flag person in the bottom left that is sending text in the maritime flag signaling pattern.</li></ul><p>The maritime / semaphore flag alphabet is documented, and I decoded the flag message to be two repetitions of:</p><ul><li>J and ‘alphabetic’ (LH out ; RH up)</li><li>B and 2 (LH down; RH out)</li><li>S (LH low; RH out)</li><li>I and 9 (LH across low; RH up)</li><li>D and 4 (LH down; RH up – or LH up; RH down)</li><li>E and 5 (LH high; RH down)</li><li>S (LH low; RH out)</li><li>T (LH up; RH high)</li><li>R (LH out; RH out)</li><li>O (LH across high; RH out)</li><li>L (LH high; RH low)</li><li>O (LH across high; RH out)</li><li>L (LH high; RH low)</li><li>O (LH across high; RH out)</li><li>L (LH high; RH low)</li><li>O (LH across high; RH out)</li></ul><p>To get result <code>BSIDESTROLOLOLOL</code>. Bummer, but at least we can cross off this lead for now.</p><ul><li><a href="https://youtu.be/_QgPMyRBBKM?t=1041">[17:21]</a> : Giant Behemoth: A message appears on the top of the screen.</li></ul><p>The message on the top of the screen was decoded, as it was quickly identified to be the <a href=https://en.wikipedia.org/wiki/Pigpen_cipher>pigpen cipher</a>.</p><p><img src=/blog/bsidespdx-down-the-rabbit-hole-pigpen.png alt="Screenshot of rune-like text, the pigpen cipher"></p><p><code>not a flag either</code></p><ul><li><a href="https://youtu.be/_QgPMyRBBKM?t=946">[15:46]</a> : In the announcement about the Secret Squadron, <code>0x13A5C</code> is displayed, and a number is heard dialing in the background.</li></ul><p>Now things get more interesting. We have the tones associated with dialing a phone number, and a message on screen. The message reads <code>0x13A5C</code>, which is <code>80476</code> in decimal.</p><p>Decoding the phone dial presses is a matter of interpreting the <a href=https://en.wikipedia.org/wiki/Dual-tone_multi-frequency_signaling>DTMF</a> tones. This requires first trimming the whole audio clip from the recording into <a href=https://github.com/lyellread/ctf-writeups/blob/master/2020-bsidesctf/down-the-rabbit-hole/dtmf.wav>a clip of just the phone dial tones</a>. This <code>.wav</code> file can then be put into <a href=https://github.com/ribt/dtmf-decoder>a dtmf decoder</a>, and it returns a phone number: <code>5038326682</code>.</p><p>For this next part, I’ll rely on what my teammates described, as I cannot call that number. However, when called, the caller is asked for a number. When provided with <code>80476</code>, the voice on the other end sounds out the following string of morse code:</p><pre tabindex=0><code>-- ... --. -. ..- -- ....- .---- -.... ---.. ...--
</code></pre><p>When decoded, this turns into the string <code>MSGNUM41683</code>, which we initially did not know what to do with. <code>41683</code> is another 5-digit number, however, so let’s just try calling 5038326682 back, and giving it our new number, shall we?</p><p>More progress! The number speaks back <code>overtheair.space</code>. This link redirects us to <a href="https://www.youtube.com/watch?v=YcArof3MXx8">an unlisted YouTube video</a> that contains more content similar to the twitch stream. In the middle of it, however, is a break, where loud beeping is heard that was instantly recognized to be <a href=https://en.wikipedia.org/wiki/Slow-scan_television>SSTV</a>. Now we need to decode that, and first that means downloading it…</p><blockquote><p>Given the tragic closure of the <code>youtube-dl</code> repository caused by RIAA, we almost resorted to <a href=https://archive.vn/VdmaG>downloading the source code off twitter, and reconstituting the youtube-dl source code from that</a>, however someone still had youtube-dl installed, and we successfully (allegedly, maybe) downloaded that video (see there is a good use for <code>youtube-dl</code>, RIAA).</p></blockquote><p>With that in hand, we extracted and trimmed the audio to <a href=https://github.com/lyellread/ctf-writeups/blob/master/2020-bsidesctf/down-the-rabbit-hole/captured_signals_sstv.wav>just the SSTV parts</a>, and then came the fun part.</p><p>Following <a href=https://ourcodeworld.com/articles/read/956/how-to-convert-decode-a-slow-scan-television-transmissions-sstv-audio-file-to-images-using-qsstv-in-ubuntu-18-04>an extremely thorough guide about how to decode this very kind of file</a>, from Carlos Delgado, we successfully set up <code>qsstv</code>, a virtual audio cable (loopback so that audio can be played from computer into <code>qsstv</code>), and we were off to the races:</p><p>I was a bit slow to start it the first time, so I got the second half first:</p><p><img src=/blog/bsidespdx-down-the-rabbit-hole-ovaltine1.png alt="Screenshot of grainy black and white video featuring a can of ovaltine and half of the CTF flag overtop"></p><p>… and the second part on the second run:</p><p><img src=/blog/bsidespdx-down-the-rabbit-hole-ovaltine2.png alt="Screenshot of grainy black and white video featuring a can of ovaltine and half of the CTF flag overtop"></p><pre tabindex=0><code>BSidesPDX{b3_sUR3_T0_dr!nk_y0Ur_Ov4ltin3}
</code></pre><p>~Lyell</p></div></div></div></main><footer class="border-top py-4 bg-light"><div class="text-muted text-center"><p>© 2024 OSU Security Club.</p><p>Contact us at: <a href=mailto:security.clubs@oregonstate.edu class="text-reset text-decoration-none fw-bold">security.clubs@oregonstate.edu</a></p></div></footer></body></html>