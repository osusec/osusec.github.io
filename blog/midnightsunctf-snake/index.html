<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><link href=https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css rel=stylesheet integrity=sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65 crossorigin=anonymous><script src=https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js integrity=sha384-kenU1KFdBIe4zVF0s0G1M5b4hcpxyD9F7jL+jjXkk+Q2h455rYXK/7HAuoJl+0I4 crossorigin=anonymous></script>
<link rel=preconnect href=https://fonts.googleapis.com><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link href="https://fonts.googleapis.com/css2?family=Mulish:wght@300;600;800&family=Open+Sans:wght@400;600&display=swap" rel=stylesheet><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.9.0/css/all.min.css integrity="sha512-q3eWabyZPc1XTCmF+8/LuE1ozpg5xxn7iO89yfSOd5/oKvyqLngoNGsx8jq92Y8eXJ/IRxQbEC+FGSYxtk2oiw==" crossorigin=anonymous referrerpolicy=no-referrer><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.9.0/css/solid.min.css integrity="sha512-LopA1sokwAW/FNZdP+/5q8MGyb9CojL1LTz8JMyu/8YZ8XaCDn1EOm6L7RWIIOHRM7K4jwnHuOmyLZeeeYxSOA==" crossorigin=anonymous referrerpolicy=no-referrer><link rel=stylesheet href=/caseyhates.css><title>MidnightsunCTF Snake++ | OSU Security Club</title></head><body id=background-img style=background-image:url(/blog/midnightsunctf-snake.jpg);background-position:50%><nav class="navbar navbar-expand-lg px-lg-5 py-lg-2 fixed-top topbar bg-light"><div class="container-fluid flex-nowrap px-lg-5"><a class=navbar-brand href=/><img src=/osusec-banner.png class=img-fluid alt=OSUSEC width=450px></a>
<button class=navbar-toggler type=button data-bs-toggle=collapse data-bs-target=#navbarSupportedContent aria-controls=navbarSupportedContent aria-expanded=false aria-label="Toggle navigation">
<span class=navbar-toggler-icon></span></button><div class="collapse navbar-collapse" id=navbarSupportedContent><ul class="navbar-nav me-auto mb-2 mb-lg-0"></ul><ul class="navbar-nav d-flex mb-2 mb-lg-0"><li class="nav-item px-1"><a class="nav-link highlight-orange-nav" href=/>Home</a></li><li class="nav-item px-1 dropdown"><a class="nav-link text-black dropdown-toggle" href=# role=button data-bs-toggle=dropdown aria-expanded=false>About</a><ul class=dropdown-menu><li><a class="dropdown-item topbar topbar-drop shadow-none" href=/about/>Who We Are</a></li><li><a class="dropdown-item topbar topbar-drop shadow-none" href=/club-constitution/>Club Constitution</a></li><li><a class="dropdown-item topbar topbar-drop shadow-none" href=/wicys/>WiCyS</a></li></ul></li><li class="nav-item px-1"><a class="nav-link highlight-orange-nav" href=/calendar/>Calendar</a></li><li class="nav-item px-1"><a class="nav-link highlight-orange-nav" href=/blog/>Blog</a></li><li class="nav-item px-1"><a class="nav-link highlight-orange-nav" href=/ctf-league/>CTF League</a></li><li class="nav-item px-1"><a class="nav-link highlight-orange-nav" href=/accomplishments/>Accomplishments</a></li><li class="nav-item px-1"><a class="nav-link highlight-orange-nav" href=/resources/>Resources</a></li></ul></div></div></nav><main id=main><div id=home-jumbotron class="jumbotron text-center hero-content infopage-hero d-flex flex-column justify-content-center"><h1 class="hero-title py-1">MidnightsunCTF Snake++</h1></div><div class="bg-light justify-content-center infopage-content" style=min-height:60vh><div class=blog-content><h1 class=blog-title>MidnightsunCTF Snake++</h1><div class="blog-subtext d-flex flex-wrap"><p class=blog-subtext-item><i class="fa fa-user"></i> Lyell Read</p><p class=blog-subtext-item><i class="fa fa-folder"></i> Tags</p><p class=blog-subtext-item><i class="fa fa-calendar"></i> <time datetime=2020-04-05>Apr 5, 2020</time></p></div><img src=/blog/midnightsunctf-snake.jpg alt="MidnightsunCTF logo" class=blogcard-img><div class=blog-content-text><h2 id=prompt>Prompt</h2><blockquote><p>141 points, 38 solves</p><p>Snake Oil Co. has invented a special programming language to play their new and improved version of Snake. Beat the game to get the flag. settings Service: nc snakeplusplus-01.play.midnightsunctf.se 55555</p></blockquote><h2 id=solution>Solution</h2><p>When I first connected to the remote server, I was presented with a menu, detailing 3 options: Play in player mode, play in computer mode, or exit. The rules detail that a score of 42 will grant you a flag, so I first tried in player mode (where I direct the snake).</p><ul><li><code>A</code> is a good apple: it grows the snake 1 in length</li><li><code>B</code> is a bad apple, it shrinks the snake in length. Best shoot these</li></ul><p>The snake is controlled with:</p><ul><li><code>L</code> – will advance the snake one place then turn the direction 90 degrees left.</li><li><code>R</code> – will advance the snake one place then turn the direction 90 degrees right.</li><li><code>' '</code> (space) will “shoot” in the direction the snake is pointed, until it hits either <code>A</code> (which it will delete), <code>B</code>, which it will delete, or your snake, or the wall. Note: you don’t die if you shoot yourself. After shooting, the snake moves forward one square</li><li><code>''</code> (enter), which will advance the snake 1 in the direction it points.</li></ul><p>When I played in player mode, I noticed no warning that no flag would be given for a win in player mode, so I figured if I could endure the tedious game (the move before turn, paired with me being bad at rights and lefts made this angering at best), I would get flag… easy, right? Two hours later, I finally reached a score of 42, and the game did not give me a flag >:(.</p><p>Now to computerize it. The language description for Snake++ is presented in <a href=https://github.com/lyellread/ctf-writeups/blob/master/2020-midnightsunctf/snake%2B%2B/lang-desc.txt>lang-desc.txt</a>.</p><p>Our game plan now becomes the writing of a function in Snake++ that can choose the next move based on board state. We implemented it in parts:</p><ul><li><a href=https://github.com/lyellread/ctf-writeups/blob/master/2020-midnightsunctf/snake%2B%2B/driver.py>driver.py</a> – supplies <a href=https://github.com/lyellread/ctf-writeups/blob/master/2020-midnightsunctf/snake%2B%2B/snake.ai>snake.ai</a> to server, and runs in while loop, detecting flag if won.</li><li><a href=https://github.com/lyellread/ctf-writeups/blob/master/2020-midnightsunctf/snake%2B%2B/snake.ai>snake.ai</a> – a misnomer, as this is really quite a dumb function (and not <em><strong>at all</strong></em> optimized, which we were too tired to see at the time). This is the Snake++ program/function that determines the move to make. This function encompasses:<ul><li>A hamiltonian cycle through the map, stored to RAM. <a href=https://github.com/lyellread/ctf-writeups/blob/master/2020-midnightsunctf/snake%2B%2B/hampath.txt>hampath.txt</a> shows this – start in left bottom corner facing right, and the move in your cell is what to submit to stay on hampath.</li><li>Logic to determine what to do based on cycle, apple type…</li></ul></li></ul><p><a href=https://github.com/lyellread/ctf-writeups/blob/master/2020-midnightsunctf/snake%2B%2B/snake.ai>snake.ai</a> loads the hamiltonian path/cycle into RAM if it is not there already (we could optimize this by not writing all the <code>F</code>‘s). Then:</p><ul><li>If we are on a turn in the hampath, we must turn</li><li>If there is a B near, return shoot (&rsquo; &lsquo;)</li><li>Else, move forward.</li></ul><blockquote><p>Note: snake.ai requires the starting (random) position to be the same direction of the hampath at that spot, so probability decrees that it works 1/4 tries.</p></blockquote><p>I know, we are all CS majors, and while you might expect a better solution from us, we are also masters of minimal effort.</p><p>So, this scrip <em><strong>barely</strong></em> works… We ran it in a loop, one run at a time (as to keep the server as fast as possible), and consistently got scores of 30-39 (there’s a 90-sec timeout for computer mode). Then, on a lucky run, we got a score of 42.</p><pre tabindex=0><code>midnight{Forbidden_fruit_is_tasty}
</code></pre><p>~ Lyell Read, Phillip Mestas, Athos</p></div></div></div></main><footer class="border-top py-4 bg-light"><div class="text-muted text-center"><p>© 2024 OSU Security Club.</p><p>Contact us at: <a href=mailto:security.clubs@oregonstate.edu class="text-reset text-decoration-none fw-bold">security.clubs@oregonstate.edu</a></p></div></footer></body></html>